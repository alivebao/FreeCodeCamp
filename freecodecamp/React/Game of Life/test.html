<html>
  <head>
    <link rel="stylesheet" type="text/css" href="../script/bootstrap-3.3.6.min.css">
    <script src="../script/react.js"></script>
    <script src="../script/react-dom.js"></script>
    <script src="../script/browser.min.js"></script>
    <script src="../script/jquery-2.1.3.min.js"></script>
    <script src="../script/bootstrap-3.3.7.min.js"></script>
  </head>
    
  <body id="life-game">
    <div class="container-fluid">      
    <div class="world-status-selector btn-group" data-toggle="buttons">
        <label class="btn btn-default" id="btn-run">
            <input type="radio" />Run
        </label>
        <label class="btn btn-default" id="btn-pause" onClick={this.props.gameStopHandler}>
            <input type="radio" />Pause
        </label>
        <label class="btn btn-default" id="btn-clear">
            <input type="radio" />Clear
        </label>
    </div>
    <span>Generation: <span id="life-generation">0</span></span>
  
    <div id="game-application">
        
    </div>
    <div class="clearfix"></div>
    <div class="world-size-selector btn-group" data-toggle="buttons">
        <label class="btn btn-default active" id="btn-50-30">
            <input type="radio" />Size: 50 * 30
        </label>
        <label class="btn btn-default" id="btn-70-50">
            <input type="radio" />Size: 70 * 50
        </label>
        <label class="btn btn-default" id="btn-100-80">
            <input type="radio" />Size: 100 * 80
        </label>
    </div>
    <div class="clearfix"></div>
    <div class="btn-group evolve-speed-selector" data-toggle="buttons">
        <label class="btn btn-default active" id="speed-slow" >
            <input type="radio" />Slow
        </label>
        <label class="btn btn-default" id="speed-medium" >
            <input type="radio" />Medium
        </label>
        <label class="btn btn-default" id="speed-fast" >
            <input type="radio" />Fast
        </label>
    </div>
    </div>
  </body>

  <script type="text/babel">
    var board = [];
    var generation = 0;
    var width;
    var height;
    var cells;
    $().ready(function() {
        setBoardSize(50, 30)
    });
    function setBoardSize(iwidth, iheight){
        width = iwidth;
        height = iheight;
        cells = iwidth * iheight;
        clearBoard()
        initCells();
        drawBoard();
    }
    function clearBoard() {
        $('#game-application').empty();
        board = [];
        for(var i = 0 ; i < cells ; i++){
            board[i] = {id: i, status: "cell dead"};
        }
        generation = 0;
        $("#game-generation").text("0");
    }
    function initCells() {
        for(var i = 0 ; i < cells; i++){
            var randomCell = Math.floor(Math.random() * 2);
            if(randomCell === 0){
                board[i] = {id: i, status: "cell dead"};
            }else{
                board[i] = {id: i, status: "cell alive"};
            }
        }
        $("#btn-50-30").click(function() {
            setBoardSize(50, 30);
        });
        $("#btn-70-50").click(function() {
            setBoardSize(70, 50);
        });
        $("#btn-100-80").click(function() {
            setBoardSize(100, 80);
        });
    }
    function drawBoard(passedBoard) {
        class ReactCell extends React.Component{
            constructor(props){
                super(props);
            }
            componentDidMount() {
                $(".cell").click(function() {
                    if($(this).hasClass("dead")){
                        $(this).removeClass("dead");
                        $(this).addClass("alive");
                    }else{
                        $(this).removeClass("alive");
                        $(this).addClass("dead");
                    }
                });
                $("#btn-clear").click(function() {
                    clearBoard();
                    drawBoard();
                });
            }
            render() {
                return (
                    <div>
                    {this.props.board.map(function(cell, i) {
                        return <div className={cell.status + (i % width === 0 ? " clearfix" : "")} key={i} id={i}></div>                        
                    })}
                    </div>
                )
            }
        }
        
        ReactDOM.render(
            <ReactCell board={board} generation={generation}></ReactCell>,
            $('#game-application')[0]
        )
    };
    
  </script>
  <style>
    #life-game .btn{
      background: #222;
      color: #ddd; 
      border: none;
      border-radius: 5px;
      height: 30px;
      margin: 5px;
    }
    #life-game .btn.active.focus {
        outline: none;
    }
    #life-game .active{
      color: #222;
      background:  #faa;
    }
    #life-game .cell{
        font-size: 9px;
        width: 12px;
        height: 12px;
        border-top: 1px solid #333;
        border-left: 1px solid #222;
        margin: 0px;
        float: left;
    }
    #life-game .dead{
        background: #000;
    }
    #life-game .alive{
        background: #fbb;
    }
    .clearfix {
        clear: both;
    }
  </style>
</html>